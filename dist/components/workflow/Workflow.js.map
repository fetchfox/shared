{"version":3,"file":"Workflow.js","names":["React","useState","useEffect","useRef","FaArrowAltCircleDown","FaCheckCircle","IoArrowUndo","useGlobalContext","Button","Input","Error","primaryColor","endpoint","NewStep","onChange","onCancel","library","nodes","Object","keys","filter","key","map","createElement","style","background","padding","borderRadius","cursor","border","onClick","fontWeight","fontSize","lineHeight","name","upperFirst","marginTop","description","display","alignItems","justifyContent","className","gridTemplateColumns","gridAutoRows","gap","StepHeader","prettyName","loading","onEdit","onDone","onSave","onRemove","marginBottom","GenericStep","step","desc","args","render","argDesc","console","log","format","x","JSON","stringify","rows","width","whiteSpace","GenericStepEdit","props","index","workflowId","onSubmit","innerComponent","GenericStepEditInner","step_","setStep_","errors","setErrors","setLoading","ctx","parse","update","value","copy","save","data","inputNode","ListInput","val","Select","choices","e","target","small","message","Step","last","workflow","extraClasses","onAddStep","onSetStepWithName","onUndo","editing","setEditing","allNull","cancel","wrap","node","submit","editNode","fallbackPrettyName","replace","pair","boxShadow","position","right","height","size","textAlign","color","Workflow","pairs","steps","undoData","setUndoData","handleSubmit","resp","fetch","method","headers","body","json","id","commit","addStep","splice","undo","setStepWithName","s","default","removeStep","removed","setTimeout","results","resultsWithItems","Array","isArray","length","done","push","i","result","lastResult"],"sources":["../../../src/components/workflow/Workflow.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { FaArrowAltCircleDown, FaCheckCircle } from 'react-icons/fa';\nimport { IoArrowUndo } from \"react-icons/io5\";\nimport { useGlobalContext }  from '@/src/contexts/index.js';\nimport { Button } from '@/src/components/input/Button.js';\nimport { Input } from '@/src/components/input/Input.js';\nimport { Error } from '@/src/components/error/Error.js';\nimport { primaryColor } from '@/src/constants.js';\nimport { endpoint } from '@/src/utils.js';\n\nconst NewStep = ({ onChange, onCancel }) => {\n  const { library } = useGlobalContext();\n\n  const nodes = Object.keys(library)\n    .filter(key => key != 'const')\n    .map((key) => (\n      <div\n        style={{ background: '#fff',\n                 padding: 10,\n                 borderRadius: 8,\n                 cursor: 'pointer',\n                 border: '1px solid #ccc',\n               }}\n        key={key}\n        onClick={() => onChange(key)}\n        >\n        <div\n          style={{ fontWeight: 'bold',\n                   fontSize: 14,\n                   lineHeight: '16px',\n                 }}\n          >\n          {library[key].name.upperFirst()}\n        </div>\n        <div\n          style={{ lineHeight: '18px',\n                   fontSize: 12,\n                   marginTop: 5,\n                 }}>\n          {library[key].description}\n        </div>\n      </div>\n    ));\n\n  return (\n    <div>\n      <div style={{ display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'space-between',\n                  }}>\n        <p>What type of step should we add?</p>\n        <button\n          className=\"bt bt-outline bt-sm\"\n          onClick={onCancel}\n          >\n          Cancel\n        </button>\n      </div>\n      <div style={{ display: 'grid',\n                    gridTemplateColumns: 'repeat(2, 1fr)',\n                    gridAutoRows: 'auto',\n                    gap: 10 }}>\n        {nodes}\n      </div>\n\n      {/*\n      <pre>{JSON.stringify(library, null, 2)}</pre>\n      */}\n    </div>\n  );\n}\n\nconst StepHeader = ({\n  prettyName,\n  loading,\n  onEdit,\n  onDone,\n  onSave,\n  onRemove,\n}) => {\n  return (\n    <div style={{ display: 'flex',\n                  justifyContent: 'space-between',\n                  fontSize: 14,\n                  fontWeight: 'bold',\n                  marginBottom: 5,\n                }}\n      >\n      <div>{prettyName}</div>\n      <div style={{ display: 'flex', gap: 5 }}>\n        {onDone && <Button\n          className=\"bt bt-trans bt-sm\"\n          onClick={onDone}\n          >\n          Cancel\n        </Button>}\n        {onRemove && <Button\n          className=\"bt bt-trans bt-sm\"\n          onClick={onRemove}\n          >\n          Remove\n        </Button>}\n        {onSave && <Button\n          className=\"bt bt-sm\"\n          onClick={onSave}\n          loading={loading}\n          >\n          Save\n        </Button>}\n        {onEdit && <Button\n          className=\"bt bt-trans bt-sm\"\n          onClick={onEdit}\n          >\n          Edit\n        </Button>}\n      </div>\n    </div>\n  );\n}\n\nconst GenericStep = ({ step, prettyName, onEdit, onRemove }) => {\n  const { library } = useGlobalContext();\n  const desc = library ? library[step?.name] : {};\n  const keys = Object.keys(step?.args);\n\n  // return (\n  //   <div>\n  //     {step?.name}<br/><br/>\n  //     {JSON.stringify(desc)}<br/><br/>\n  //     {JSON.stringify(keys)}<br/><br/>\n  //     {JSON.stringify(library)}<br/><br/>\n  //   </div>\n  // );\n\n  // const desc = library ? library[step?.name] : {};\n  // const keys = Object.keys(step?.args);\n  // const keys = Object.keys(desc?.args);\n\n  if (!desc?.args) return null;\n\n  const render = (key) => {\n    if (!desc) return null;\n\n    const argDesc = desc.args[key];\n\n    console.log('key', key);\n    console.log('step.args', step.args);\n    console.log('argDesc', argDesc);\n\n    switch (argDesc.format) {\n      case 'list':\n        return <ul>{step.args[key].map(x => <li>{x}</li>)}</ul>;\n\n      case 'object':\n        return JSON.stringify(step.args);\n\n      case 'boolean':\n        return step.args[key] ? 'yes' : 'no';\n\n      case 'choices':\n        return step.args[key];\n\n      default:\n        return JSON.stringify(step.args[key]);\n    }\n  }\n\n  const rows = keys.map(key => (\n    <tr>\n      <th style={{ width: '100px', whiteSpace: 'nowrap' }}>{key.upperFirst()}</th>\n      <td style={{ width: '100%' }}>{render(key)}</td>\n    </tr>\n  ));\n\n  return (\n    <div>\n      <StepHeader\n        prettyName={prettyName}\n        onEdit={onEdit}\n        onRemove={onRemove}\n      />\n\n      <table className=\"dense\">\n        <tbody>{rows}</tbody>\n      </table>\n    </div>\n  );\n}\n\nconst GenericStepEdit = (props) => {\n  const {\n    step,\n    index,\n    workflowId,\n    prettyName,\n    onSubmit,\n    onDone,\n    onRemove,\n  } = props;\n\n  const innerComponent = props.innerComponent || GenericStepEditInner;\n\n  const [step_, setStep_] = useState({});\n  const [errors, setErrors] = useState();\n  const [loading, setLoading] = useState();\n  const ctx = useGlobalContext();\n\n  const desc = ctx.library[step?.name];\n\n  useEffect(() => {\n    if (!step) return;\n    setStep_(JSON.parse(JSON.stringify(step)));\n  }, [step]);\n\n  const update = (key, value) => {\n    const copy = { ...step_ };\n    copy.args[key] = value;\n    setStep_(copy);\n  }\n\n  const save = async () => {\n    setLoading(true);\n    setErrors(null);\n    const data = await onSubmit(step_);\n    if (data?.errors) {\n      setErrors(data?.errors);\n    } else {\n      onDone();\n    }\n    setLoading(false);\n  }\n\n  return innerComponent({\n    ...props,\n    step: step_,\n    desc,\n    errors,\n    loading,\n    onSave: save,\n    onChange: update,\n  });\n}\n\nconst GenericStepEditInner = ({\n  step,\n  desc,\n  loading,\n  errors,\n  index,\n  workflowId,\n  prettyName,\n  onChange,\n  onDone,\n  onSave,\n}) => {\n\n  const keys = Object.keys(step.args || {});\n  const rows = keys.map(key => {\n    if (!desc) return null;\n\n\n    const argDesc = desc.args[key];\n    let inputNode = (\n      <div>\n        TODO{JSON.stringify(argDesc.format)}<br/>\n        TODO{JSON.stringify(step.args[key])}<br/>\n      </div>\n    );\n\n    switch (argDesc.format) {\n      case 'list':\n        inputNode = (\n          <ListInput\n            style={{ width: '100%' }}\n            value={step.args[key]}\n            onChange={(val) => onChange(key, val)}\n          />\n        );\n        break;\n\n      case 'choices':\n        inputNode = (\n          <Select\n            style={{ width: '100%' }}\n            choices={argDesc.choices.map(x => [x])}\n            value={step.args[key]}\n            onChange={(val) => onChange(key, val)}\n          />\n        );\n        break;\n\n      case 'boolean':\n        inputNode = (\n          <Select\n            style={{ width: '100%' }}\n            choices={[[true, 'yes'], [false, 'no']]}\n            value={step.args[key]}\n            onChange={(val) => onChange(key, val)}\n          />\n        );\n        break;\n\n      default:\n        inputNode = (\n          <Input\n            style={{ width: '100%' }}\n            value={step.args[key]}\n            onChange={(e) => onChange(key, e.target.value)}\n          />\n        );\n        break;\n    }\n\n    return (\n      <tr>\n        <th style={{ width: '100px', whiteSpace: 'nowrap' }}>\n          {key.upperFirst()}\n        </th>\n        <td style={{ width: '100%' }}>\n          {inputNode}\n          <Error small message={errors && errors[key]} />\n        </td>\n      </tr>\n    );\n  });\n\n  return (\n    <div>\n      <StepHeader\n        prettyName={prettyName}\n        loading={loading}\n        onDone={onDone}\n        onSave={onSave}\n      />\n      <div>\n        <table className=\"dense\">\n          <tbody>{rows}</tbody>\n        </table>\n      </div>\n\n      {/*\n      <pre>desc:{JSON.stringify(desc, null, 2)}</pre>\n      */}\n    </div>\n  );\n}\n\n\nexport const Step = ({\n  index,\n  step,\n  last,\n  workflow,\n  workflowId,\n  extraClasses,\n  onSubmit,\n  onAddStep,\n  onSetStepWithName,\n  onRemove,\n  onUndo,\n}) => {\n\n  const [loading, setLoading] = useState();\n  const [editing, setEditing] = useState();\n\n  useEffect(() => {\n    let allNull = true;\n    for (const key of Object.keys(step?.args || {})) {\n      if (step.args[key] != null) allNull = false;\n    }\n    if (allNull) {\n      setEditing(true);\n    }\n  }, [step?.name]);\n\n  const cancel = () => {\n    setEditing(false);\n  }\n\n  const wrap = (node) => {\n    return (\n      <form onSubmit={submit}>\n        {node}\n      </form>\n    );\n  }\n\n  let node;\n  let editNode;\n\n  if (step.name == 'new') {\n    editNode = (\n      <NewStep\n        onChange={(name) => onSetStepWithName(name, index)}\n        onCancel={onRemove}\n      />\n    );\n  } else {\n    //const fallbackPrettyName = `Step ${index + 1}: ${step.name.replace(/-/g, ' ').upperFirst()}`;\n    const fallbackPrettyName = `${step.name.replace(/-/g, ' ').upperFirst()}`;\n\n    let pair = null;\n\n    // let pair = {\n    //   'const': [\n    //     <ConstStep\n    //       index={index}\n    //       step={step}\n    //       prettyName={`Initialize`}\n    //     />,\n    //     null,\n    //   ],\n    //   'exportUrls': [\n    //     <ExportUrlsStep\n    //       index={index}\n    //       step={step}\n    //       workflow={workflow}\n    //       prettyName={`Export Files`}\n    //       onEdit={() => setEditing(true)}\n    //       onRemove={onRemove}\n    //     />,\n    //     <ExportUrlsStepEdit\n    //       index={index}\n    //       step={step}\n    //       workflow={workflow}\n    //       prettyName={`Export Files`}\n    //       onSubmit={onSubmit}\n    //       onDone={() => setEditing(false)}\n    //       onRemove={onRemove}\n    //     />,\n    //   ],\n    // }[step.name];\n\n    if (!pair) {\n      pair = [\n        <GenericStep\n          index={index}\n          step={step}\n          prettyName={fallbackPrettyName}\n          onEdit={() => setEditing(true)}\n          onRemove={onRemove}\n        />,\n        <GenericStepEdit\n          step={step}\n          index={index}\n          workflowId={workflowId}\n          prettyName={fallbackPrettyName}\n          onSubmit={onSubmit}\n          onDone={() => setEditing(false)}\n          onRemove={onRemove}\n        />,\n      ];\n    }\n\n    node = pair[0];\n    editNode = pair[1];\n  }\n\n  return (\n    <div className={extraClasses}>\n      <div style={{ border: '1px solid #ccc',\n                    background: '#f3f3f3',\n                    boxShadow: `2px 2px #eee`,\n                    borderRadius: 4,\n                    padding: 10,\n                    fontSize: 14,\n                  }}>\n        {!editing && node}\n        {editing && editNode}\n      </div>\n\n      <div style={{ position: 'relative' }}>\n        <div style={{ position: 'absolute',\n                      right: 0,\n                      height: 46,\n                      display: 'flex',\n                      alignItems: 'center',\n                    }}>\n          {onUndo && <button\n            className=\"bt bt-white bt-sm\"\n            onClick={onUndo}\n            >\n            <IoArrowUndo style={{ marginTop: -2 }} size={14} /> Undo\n          </button>}\n          {<button\n            className=\"bt bt-white bt-sm\"\n            onClick={onAddStep}\n            >\n            Add Step\n          </button>}\n        </div>\n      {!last && (\n        <div style={{ padding: 10,\n                      width: '100%',\n                      textAlign: 'center',\n                      color: primaryColor,\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n        }}>\n        <FaArrowAltCircleDown size={24} />\n        </div>\n       )}\n      </div>\n    </div>\n  );\n}\n\nexport const Workflow = ({ workflow, onChange }) => {\n  const { library } = useGlobalContext();\n  const pairs = [];\n  const steps = workflow?.steps || [];\n  const [undoData, setUndoData] = useState();\n\n  const handleSubmit = async (index, step) => {\n    const copy = JSON.parse(JSON.stringify(workflow));\n    copy.steps[index] = step;\n\n    const resp = await fetch(\n      endpoint(`/api/workflow/validate`),\n      {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ steps: copy.steps }),\n      });\n    const data = await resp.json();\n    console.log('validate resp', data);\n    if (data.errors) {\n      return { errors: data.errors[index] };\n    }\n\n    if (workflow.id) {\n      const data = await commit(copy);\n      if (data.errors) return { errors: data.errors[index] };\n      onChange(data.workflow);\n    } else {\n      onChange(copy);\n    }\n  }\n\n  const addStep = async (step, index) => {\n    const copy = JSON.parse(JSON.stringify(workflow));\n    copy.steps.splice(index, 0, step);\n\n    // const d = {};\n    // d[index] = 'add-animation';\n    // setExtraClasses(d);\n    // setTimeout(() => setExtraClasses(d), 1);\n    // setTimeout(() => setExtraClasses({}), 150);\n\n    if (step.name != 'new' && workflow.id) {\n      const data = await commit(copy);\n      if (data.errors) return { errors: data.errors[index] };\n      onChange(data.workflow);\n    } else {\n      onChange(copy);\n    }\n  }\n\n  const undo = () => {\n    addStep(undoData.step, undoData.index);\n    setUndoData(null);\n  }\n\n  const setStepWithName = async (name, index) => {\n    const s = { name, args: {} };\n    const desc = library[name];\n    for (const key of Object.keys(desc.args)) {\n      s.args[key] = desc.args[key].default || null;\n    }\n\n    const copy = JSON.parse(JSON.stringify(workflow));\n    copy.steps[index] = s;\n    onChange(copy);\n  }\n\n  const removeStep = async (index) => {\n    const copy = JSON.parse(JSON.stringify(workflow));\n    const removed = JSON.parse(JSON.stringify(copy.steps[index]));\n    copy.steps.splice(index, 1);\n\n    onChange(copy);\n    setUndoData({ step: removed, index });\n    setTimeout(() => setUndoData(null), 4000);\n\n    if (workflow.id) {\n      const data = await commit(copy);\n      if (data.errors) return { errors: data.errors[index] };\n      onChange(data.workflow);\n    } else {\n      onChange(copy);\n    }\n  }\n\n  // TODO\n  const results = [];\n\n  let resultsWithItems = [];\n  if (results && Array.isArray(results)) {\n    resultsWithItems = results;\n      // .filter(x => (\n      //   x.error ||\n      //   x.didStart ||\n      //   x.items && x.items.length > 0\n      // ));\n  }\n\n  // Special case to show loading if:\n  // - Last step in resultsWithItems is `done`\n  // - The next item does not have `didStart` set\n  if (\n    resultsWithItems &&\n    results &&\n    resultsWithItems.length > 0 &&\n    resultsWithItems.length < results.length &&\n    resultsWithItems[resultsWithItems.length - 1].done)\n  {\n    // Deep copy and set it to `loading`\n    resultsWithItems.push(JSON.parse(JSON.stringify(\n      results[resultsWithItems.length]\n    )));\n    resultsWithItems[resultsWithItems.length - 1].loading = true;\n  }\n\n  for (let i = 0; i < steps.length; i++) {\n    pairs.push({\n      step: steps[i],\n      result: i >= (resultsWithItems || []).length ? {} : resultsWithItems[i],\n    });\n  }\n\n  let i = 0;\n  const nodes = pairs.map(pair => {\n    const index = i++;\n\n    const props = {\n      key: index,\n      index: index,\n      last: index == workflow?.steps.length - 1,\n      lastResult: index == resultsWithItems.length - 1,\n      // done: done,\n      // running: running,\n      step: pair.step,\n      result: pair.result,\n      workflow: workflow,\n      workflowId: workflow.id,\n      onSubmit: (val) => handleSubmit(index, val),\n      onAddStep: () => addStep({ name: 'new', args: {} }, index + 1),\n      onSetStepWithName: (name, index) => setStepWithName(name, index),\n      onRemove: () => removeStep(index),\n      onUndo: undoData?.index == index + 1 ? undo : null,\n    };\n\n    return <Step {...props} />;\n    // if (withResults) {\n    //   return <Pair {...props} />;\n    // } else {\n    //   return <Step {...props} />;\n    // }\n  });\n\n  return (\n    <div>\n      {nodes}\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]}